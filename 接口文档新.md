# sxzx的后台接口



## 评论模块



### 获取用户评论数据(有分页并且附带事项指南，规则等信息)

- method: ==GET==
- url: ==/api/v1/comment==
- req:

	| 字段    | 类型 | 说明     | 是否必填                   |
| ------- | ---- | -------- | -------------------------- |
| pageNum | int  | 当前页数 | 选填，如果不填默认访问全部 |
| score   | int  | 分数     | 选填，如果不填返回全部分数 |

- parameter: 

  | 字段         | 类型    | 说明         |
  | ------------ | ------- | ------------ |
  | create_time  | string  | 创建时间     |
  | idc          | string  | 身份证证件号 |
  | show_status  | boolean | 显示状态     |
  | check_status | boolean | 审核状态     |
  | content      | string  | 显示内容     |
  | idc_type     | string  | 证件类型     |
  | score        | int     | 分数         |
  | item_id      | string  | 事项编码     |
  | rule         | object  | 规则         |
  | task         | object  | 事项指南     |
  | item_rule    | object  | 事项规则     |

+ response body

  ```json
  {
      "code": 200,
      "msg": "获取评论成功",
      "data": [
          {
              "_id": "618cddc4e1eab58f7e2cebb9",
              "create_time": "1636621270908",
              "idc": "61528e552636e54f1bc9f422",
              "show_status": false,
              "check_status": false,
              "content": "我很满意",
              "idc_type": "居民身份证",
              "score": "3",
              "item_id": "430425200107050375X51564654",
              "__v": 0,
              "rule": {
                  "_id": "61528e552636e54f1bc9f41f",
                  "__v": 0,
                  "parentId": "0",
                  "rule_id": "1",
                  "rule_name": "个人业务/社会保险/社保卡遗失补办"
              },
              "task": {
                  "_id": "61d53cb1d529e756011214df",
                  "task_code": "11440100696927671X344211101D001",
                  "task_name": "技能人员职业资格证书查询",
                  "audit_material": [],
                  "audit_catalog_lobby": [],
                  "wsbllc": "1.登录广东省人力资源和社会保障厅网上服务平台进入相应查询入口（https://ggfw.gdhrss.gov.cn/gdggfw-service/service/certificate/qsgjzyzgzs.shtml?gdbsTokenId=）；\n2.输入姓名、身份证件号码或者证书号码；\n3.生成查询结果，查询人可自行下载。",
                  "ckbllc": null,
                  "__v": 0
              },
              "item_rule": {
                  "_id": "615289bf0c267e8e00512310",
                  "__v": "0",
                  "content": "个人业务办理请前往scut",
                  "create_time": "1632799167009",
                  "rule_id": "1"
              }
          },
      ]
  }
  ```



### 获取全部评论

- method: ==GET==
- url: ==/api/v1/allComment==
- req:

- parameter: 

  | 字段         | 类型    | 说明         |
  | ------------ | ------- | ------------ |
  | create_time  | string  | 创建时间     |
  | idc          | string  | 身份证证件号 |
  | show_status  | boolean | 显示状态     |
  | check_status | boolean | 审核状态     |
  | content      | string  | 显示内容     |
  | idc_type     | string  | 证件类型     |
  | score        | int     | 分数         |
  | item_id      | string  | 事项编码     |

+ response body

  ```json
  {
      "code": 200,
      "msg": "获取评论成功",
      "data": [
           {
              "_id": "618cdda9e1eab58f7e2ceba1",
              "create_time": "1636621270908",
              "idc": "61528e552636e54f1bc9f422",
              "show_status": false,
              "check_status": false,
              "content": "我很满意",
              "idc_type": "居民身份证",
              "score": "1",
              "item_id": "430425200107050375X51564654",
              "__v": 0
          },
      ]
  }
  ```



### 保存用户评论

- method: ==POST==

- url: ==/api/v1/comment==

- req:

  | 字段         | 类型    | 说明         |
  | ------------ | ------- | ------------ |
  | idc          | string  | 身份证证件号 |
  | show_status  | boolean | 显示状态     |
  | check_status | boolean | 审核状态     |
  | content      | string  | 显示内容     |
  | idc_type     | string  | 证件类型     |
  | score        | int     | 分数         |
  | item_id      | string  | 事项编码     |

- parameter: 

  | 字段         | 类型    | 说明         |
  | ------------ | ------- | ------------ |
  | create_time  | string  | 创建时间     |
  | idc          | string  | 身份证证件号 |
  | show_status  | boolean | 显示状态     |
  | check_status | boolean | 审核状态     |
  | content      | string  | 显示内容     |
  | idc_type     | string  | 证件类型     |
  | score        | int     | 分数         |
  | item_id      | string  | 事项编码     |

+ response body

  ```json
  {
      "code": 200,
      "msg": "获取评论成功",
      "data": [
           {
              "_id": "618cdda9e1eab58f7e2ceba1",
              "create_time": "1636621270908",
              "idc": "61528e552636e54f1bc9f422",
              "show_status": false,
              "check_status": false,
              "content": "我很满意",
              "idc_type": "居民身份证",
              "score": "1",
              "item_id": "430425200107050375X51564654",
              "__v": 0
          },
      ]
  }
  ```



### 获取评价参数

- method: ==GET==
- url: ==/api/v1/commentParam==
- req:

- parameter: 

  | 字段      | 类型   | 说明         |
  | --------- | ------ | ------------ |
  | totalNum  | int    | 评论总数     |
  | avgScore  | double | 平均分       |
  | scoreInfo | array  | 分数信息数组 |
  | score     | int    | 分数         |
  | count     | int    | 数量         |

+ response body

  ```json
  {
      "code": 200,
      "msg": "获取评论参数成功",
      "data": {
          "totalNum": 31,
          "avgScore": 2.870967741935484,
          "scoreInfo": [
              {
                  "score": "1",
                  "count": 7
              },
              {
                  "score": "2",
                  "count": 6
              },
              {
                  "score": "3",
                  "count": 8
              },
              {
                  "score": "4",
                  "count": 4
              },
              {
                  "score": "5",
                  "count": 6
              }
          ]
      }
  }
  ```



### 搜索评论

- method: ==POST==
- url: ==/api/v1/searchComment==
- req:

| 字段      | 类型   | 说明                                                         |
| --------- | ------ | ------------------------------------------------------------ |
| startTimt | String | 可选                                                         |
| endTime   | String | 可选                                                         |
| score     | int    | 可选，分数                                                   |
| type      | int    | 可选，搜索类型，但是如果有typeData则必须要，1是根据身份证，2是根据事项指南名称，3是根据事项指南编码，4是根据规则名称 |
| typeData  | String | 可选，搜素内容                                               |

- parameter: 

| 字段         | 类型       | 说明         |
| ------------ | ---------- | ------------ |
| create_time  | string     | 创建时间     |
| idc          | string     | 身份证证件号 |
| show_status  | boolean    | 显示状态     |
| check_status | boolean    | 审核状态     |
| content      | string     | 显示内容     |
| idc_type     | string     | 证件类型     |
| score        | int        | 分数         |
| item_id      | string     | 事项编码     |
| rule         | objecttask | 规则         |
| task         | object     | 事项指南     |
| item_rule    | object     | 事项规则     |

```json
{
    "code": 200,
    "msg": "查询成功",
    "data": [
        {
            "_id": "618cdda9e1eab58f7e2ceba1",
            "create_time": "1636621270908",
            "idc": "61528e552636e54f1bc9f422",
            "show_status": false,
            "check_status": false,
            "content": "我很满意",
            "idc_type": "居民身份证",
            "score": "1",
            "item_id": "430425200107050375X51564654",
            "__v": 0,
            "rule": {
                "_id": "61528e552636e54f1bc9f41f",
                "__v": 0,
                "parentId": "0",
                "rule_id": "1",
                "rule_name": "个人业务/社会保险/社保卡遗失补办"
            },
            "task": {
                "_id": "61d53cb1d529e756011214df",
                "task_code": "11440100696927671X344211101D001",
                "task_name": "技能人员职业资格证书查询",
                "audit_material": [],
                "audit_catalog_lobby": [],
                "wsbllc": "1.登录广东省人力资源和社会保障厅网上服务平台进入相应查询入口（https://ggfw.gdhrss.gov.cn/gdggfw-service/service/certificate/qsgjzyzgzs.shtml?gdbsTokenId=）；\n2.输入姓名、身份证件号码或者证书号码；\n3.生成查询结果，查询人可自行下载。",
                "ckbllc": null,
                "__v": 0
            },
            "item_rule": {
                "_id": "615289bf0c267e8e00512310",
                "__v": "0",
                "content": "个人业务办理请前往scut",
                "create_time": "1632799167009",
                "rule_id": "1"
            }
        },
    ]
}
```

### 获取规则树

- method: GET
- url: /api/v1/getRuleTree
- req: 不需要请求体
- response: 数组，数组成员是一个object

| 字段 | 类型 | 说明 |
| ---- | ---- | ---- |
| rule_id   | string | 规则id   |
| rule_name | string | 规则名称 |
| parentId  | string | 父规则id，根节点的parentId是空字符串且其规则名称是“分类规则标准” |

```json
{
    "code": 200,
    "msg": "获取规则树成功",
    "data": [
        {
            "rule_id": "1",
            "rule_name": "xxx",
            "parentId": "0"
        },
        ...
    ]
}
```

### 获取区划树

- method: GET
- url: /api/v1/getRegionTree
- req: 不需要请求体
- response: 数组，数组成员是一个object

| 字段 | 类型 | 说明 |
| ---- | ---- | ---- |
| region_id | string | 区划id |
| region_name | string | 区划名称 |
| region_level | number | 区划等级，0表示最高级及广州市 |
| parentId | string | 上级区划id，根节点的parentId是空字符串 |

```json
{
    "code": 200,
    "msg": "获取区划树成功",
    "data": [
        {
            "region_id": "440115000000",
            "region_name": "南沙区",
            "region_level": 1,
            "parentId": "440100000000"
        },
        ...
    ]
}
```

### 通过唯一id获取事项

- method: GET
- url: /api/v1/getItemByUniId
- req: 请求体中需要item_id或task_code字段，两个字段都存在则只使用item_id

| 字段 | 类型 | 说明 |
| ---- | ---- | ---- |
| item_id | string | 可选，事项id（优先使用） |
| task_code | string | 可选，事项指南实施编码 |

- response: 数组，数组成员是一个object，且数组只有0个或1个成员

| 字段 | 类型 | 说明 |
| ---- | ---- | ---- |
| item_id | string | 事项id |
| release_time | string | 事项的发布时间 |
| item_status | boolean | 事项状态 |
| create_time | string | 事项的创建时间 |
| task_code | string | 事项指南实施编码 |
| item_rule_id | string | 事项规则id |

```json
{
    "code": 200,
    "msg": "查询成功",
    "data": [
        {
            "item_id": "0",
            "release_time": "",
            "item_status": 0,
            "create_time": "1642418186535",
            "task_code": "11440100696927671X344211100300101",
            "item_rule_id": "0"
        }
    ]
}
```

### 获取事项

- method: GET
- url: /api/v1/getItems
- req: 请求体中有4个可选字段，没有则返回全部事项

| 字段 | 类型 | 说明 |
| ---- | ---- | ---- |
| release_time | string | 可选，事项的发布时间 |
| item_status | string | 可选，事项状态 |
| create_time | string | 可选，事项的创建时间 |
| item_rule_id | string | 可选，事项规则id |

- response: 数组，数组成员是一个object

| 字段 | 类型 | 说明 |
| ---- | ---- | ---- |
| item_id | string | 事项id |
| release_time | string | 事项的发布时间 |
| item_status | number | 事项状态 |
| create_time | string | 事项的创建时间 |
| task_code | string | 事项指南实施编码 |
| item_rule_id | string | 事项规则id |

```json
{
    "code": 200,
    "msg": "查询成功",
    "data": [
        {
            "item_id": "0",
            "release_time": "",
            "item_status": 0,
            "create_time": "1642418186535",
            "task_code": "11440100696927671X344211100300101",
            "item_rule_id": "0"
        },
        ...
    ]
}
```

### 通过规则id获取事项

- method: GET
- url: /api/v1/getItemsByRuleId
- req: 请求体中必须有rule_id字段，其他字段可用于筛选事项

| 字段 | 类型 | 说明 |
| --- | --- | --- |
| rule_id | string | 规则id |
| item_status | number | 可选，事项状态 |
| release_time | string | 可选，事项发布时间 |
| create_time | string | 可选，事项创建时间 |

- response: 数组，数组成员是一个object

| 字段 | 类型 | 说明 |
| ---- | ---- | ---- |
| item_id | string | 事项id |
| release_time | string | 事项的发布时间 |
| item_status | number | 事项状态 |
| create_time | string | 事项的创建时间 |
| task_code | string | 事项指南实施编码 |
| item_rule_id | string | 事项规则id |

```json
{
    "code": 200,
    "msg": "查询成功",
    "data": [
        {
            "item_id": "29",
            "release_time": "",
            "item_status": 0,
            "create_time": "1642418186882",
            "task_code": "11440115783785421N4442111528003",
            "item_rule_id": "25"
        }
    ]
}
```

### 通过区划id获取该区划的事项

- method: GET
- url: /api/v1/getItemsByRegionId
- req: 请求体中必须有region_id字段，其他字段可用于筛选事项

| 字段 | 类型 | 说明 |
| --- | --- | --- |
| region_id | string | 区划id |
| item_status | number | 可选，事项状态 |
| release_time | string | 可选，事项发布时间 |
| create_time | string | 可选，事项创建时间 |

- response: 数组，数组成员是一个object

| 字段 | 类型 | 说明 |
| ---- | ---- | ---- |
| item_id | string | 事项id |
| release_time | string | 事项的发布时间 |
| item_status | number | 事项状态 |
| create_time | string | 事项的创建时间 |
| task_code | string | 事项指南实施编码 |
| item_rule_id | string | 事项规则id |

```json
{
    "code": 200,
    "msg": "查询成功",
    "data": [
        {
            "item_id": "81",
            "release_time": "",
            "item_status": 0,
            "create_time": "1642418187491",
            "task_code": "TE44011544011544005442111641000",
            "item_rule_id": "68"
        },
        ...
    ]
}
```

### 通过区划id获取该区划及其下级区划的全部事项

- method: GET
- url: /api/v1/getAllItemsByRegionId
- req: 请求体中必须有region_id字段，其他字段可用于筛选事项

| 字段 | 类型 | 说明 |
| --- | --- | --- |
| region_id | string | 区划id |
| item_status | number | 可选，事项状态 |
| release_time | string | 可选，事项发布时间 |
| create_time | string | 可选，事项创建时间 |

- response: 数组，数组成员是一个object

| 字段 | 类型 | 说明 |
| ---- | ---- | ---- |
| item_id | string | 事项id |
| release_time | string | 事项的发布时间 |
| item_status | number | 事项状态 |
| create_time | string | 事项的创建时间 |
| task_code | string | 事项指南实施编码 |
| item_rule_id | string | 事项规则id |

```json
{
    "code": 200,
    "msg": "查询成功",
    "data": [
        {
            "item_id": "1",
            "release_time": "",
            "item_status": 0,
            "create_time": "1642418186548",
            "task_code": "11440100696927671X344211100300101",
            "item_rule_id": "1"
        },
        ...
    ]
}
```

### 获取规则

- method: GET
- url: /api/v1/getRules
- req: 请求体中有3个可选字段，没有则返回全部规则

| 字段 | 类型 | 说明 |
| --- | --- | --- |
| rule_id | string | 可选，规则id |
| rule_name | string | 可选，规则名称 |
| parentId | string | 可选，父规则id |

- response: 数组

| 字段 | 类型 | 说明 |
| --- | --- | --- |
| rule_id | string | 规则id |
| rule_name | string | 规则名称 |
| parentId | string | 父规则id |

```json
{
    "code": 200,
    "msg": "获取规则成功",
    "data": [
        {
            "rule_id": "1",
            "rule_name": "个人业务",
            "parentId": "0"
        }
    ]
}
```

### 获取规则路径

- method: GET
- url: /api/v1/getRulePath
- req: 数组，数组成员是一个字符串，代表规则id

| 字段 | 类型 | 说明 |
| --- | --- | --- |
| ruleIds | Array | 规则id数组 |

- response: 二维数组，传入多少个规则id就返回多少条规则路径

| 字段 | 类型 | 说明 |
| --- | --- | --- |
| rule_id | string | 规则id |
| rule_name | string | 规则名称 |
| parentId | string | 父规则id |

```json
{
    "code": 200,
    "msg": "获取规则路径成功",
    "data": [
        [
            {
                "rule_id": "2",
                "rule_name": "法人业务",
                "parentId": "0"
            },
            {
                "rule_id": "8",
                "rule_name": "人事人才",
                "parentId": "2"
            },
            {
                "rule_id": "37",
                "rule_name": "民办职业培训",
                "parentId": "8"
            },
            {
                "rule_id": "97",
                "rule_name": "民办职业培训机构名称查询申请",
                "parentId": "37"
            },
            {
                "rule_id": "173",
                "rule_name": "名称延期",
                "parentId": "97"
            }
        ]
    ]
}
```